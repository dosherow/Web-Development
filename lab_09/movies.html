<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>The Movie DB API</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
	<style>
		#movie-container img {
			max-width: 100%;
			height: auto;
			margin-bottom: 10px;
		}
		big + div {
			font-style: italic;
		}
	</style>
</head>
<body>
	<div class="container">
		<div class="row">
			<h1 class="col-12 mt-4">Movie Search</h1>
		</div> <!-- .row -->

		<div class="row">
			<form class="col-12" id="search-form">
				<div class="form-row">
					<div class="col-12 mt-4 col-sm-6 col-md-4 col-lg-3">
						<label for="search-term" class="sr-only">Search:</label>

						<input type="text" name="" id="search-term" class="form-control" placeholder="Search...">

					</div>
					<div class="col-12 mt-4 col-sm-auto">
						<button type="submit" class="btn btn-primary btn-block">Search</button>
					</div>
				</div> <!-- .form-row -->
			</form>
		</div> <!-- .row -->

		<div class="row">
			<div class="col-12 mt-4 mb-4">

				Showing <span id="num-results" class="font-weight-bold">0</span> of <span id="num-total" class="font-weight-bold">0</span> result(s).
				
			</div>
		</div> <!-- .row -->
		
		<div id="movie-container" class="row">

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Venom" src="http://image.tmdb.org/t/p/w500/2uNW4WbgBXL25BAbXGLnLqX71Sw.jpg">
				<big>Venom</big>
				<div>2018-10-03</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="A Star Is Born" src="http://image.tmdb.org/t/p/w500/wrFpXMNBRj2PBiN4Z5kix51XaIZ.jpg">
				<big>A Star Is Born</big>
				<div>2018-10-03</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="The Predator" src="http://image.tmdb.org/t/p/w500/wMq9kQXTeQCHUZOG4fAe5cAxyUA.jpg">
				<big>The Predator</big>
				<div>2018-09-13</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Halloween" src="http://image.tmdb.org/t/p/w500/lNkDYKmrVem1J0aAfCnQlJOCKnT.jpg">
				<big>Halloween</big>
				<div>2018-10-18</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="First Man" src="http://image.tmdb.org/t/p/w500/i91mfvFcPPlaegcbOyjGgiWfZzh.jpg">
				<big>First Man</big>
				<div>2018-10-11</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="The Nun" src="http://image.tmdb.org/t/p/w500/sFC1ElvoKGdHJIWRpNB3xWJ9lJA.jpg">
				<big>The Nun</big>
				<div>2018-09-05</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Mile 22" src="http://image.tmdb.org/t/p/w500/dT1XzjxRDR56xOm4Ph0INV4EmWJ.jpg">
				<big>Mile 22</big>
				<div>2018-08-16</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Johnny English Strikes Again" src="http://image.tmdb.org/t/p/w500/tCBxnZwLiY1BOKw3tH6AxHZdqPh.jpg">
				<big>Johnny English Strikes Again</big>
				<div>2018-09-13</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Incredibles 2" src="http://image.tmdb.org/t/p/w500/x1txcDXkcM65gl7w20PwYSxAYah.jpg">
				<big>Incredibles 2</big>
				<div>2018-06-14</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Goosebumps 2: Haunted Halloween" src="http://image.tmdb.org/t/p/w500/8bcpki9GfXdXj9esFpPtlate8v0.jpg">
				<big>Goosebumps 2: Haunted Halloween</big>
				<div>2018-10-11</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Smallfoot" src="http://image.tmdb.org/t/p/w500/4nKoB6wMVXfsYgRZK5lHZ5VMQ6J.jpg">
				<big>Smallfoot</big>
				<div>2018-09-20</div>
			</div>

			<div class="text-center my-3 col-6 col-sm-4 col-md-3 col-lg-2">
				<img alt="Skyscraper" src="http://image.tmdb.org/t/p/w500/5LYSsOPzuP13201qSzMjNxi8FxN.jpg">
				<big>Skyscraper</big>
				<div>2018-07-11</div>
			</div>

		</div> <!-- .row -->
	</div> <!-- .container -->

	<script>

		// create event handler for form submission 
			// a. the form does not submit anywhere 

		document.querySelector("#search-form").onsubmit = function() {

			// b. save user input into a variable 
			var search = document.querySelector("#search-term").value.trim();

			// c. if user input is not empty: 
				// i. create variable to store the request URL
				// replace API_KEY with your API key and SEARCH_TERM with user input

				if ( search.length >= 1 ) {
					var url = "https://api.themoviedb.org/3/search/movie?api_key=387d275b98340b02402eee46d32a5394&query=" + search;

				// invoke ajax() function passing the request URL as parameter 

					ajax(url);

				// clear user input from the form field
				
				document.querySelector("#search-term").innerHTML = "";	

					
				}
					return false;
				
		}	


		// create ajax() function that will make requests to the API
		function ajax(url) {
			// create AJAX object 
			var xhr = new XMLHttpRequest();

			// .open(Method [GET/POST], url, Async? [true/false])
			xhr.open('GET', url, true);

			// onload Event Handler. Triggered when response is loaded
			xhr.onload = function() {
				if ( xhr.status	== 200) {

					// success
					console.log(xhr.responseText);
					displayData(JSON.parse(xhr.responseText) );

				}

				else {
					// error
					alert("AJAX Error");
					console.log(xhr);
				}
			};

			xhr.send();
		}


		// create function invoked by ajax()

		function displayData(data) {

		// set content of <span id="num-results"> to number of results returned by the API (length of results array)

		document.querySelector("#num-results").innerHTML = data.results.length;

		// set content of <span id="num-total"> to total number or results the API has. 

		document.querySelector("#num-total").innerHTML = data.total_results;

		// clear the list of movies currently displayed in the DOM

		document.querySelector("#movie-container").innerHTML = "";

		// loop through the results array and for each movie display movie poster, title, and release date in the same format as hard-coded data. 

		for ( var i = 0; i < data.results.length; i++ ) {

			var div = document.createElement('div');
			var img = document.createElement('img');
			var title = document.createElement('big');
			var date = document.createElement('div');

			var imgSrc = "https://image.tmdb.org/t/p/w500" + data.results[i].poster_path;

			img.src = imgSrc;
			img.alt = data.results[i].title;

			div.classList.add('text-center', 'my-3', 'col-6', 'col-sm-4', 'col-md-3', 'col-lg-2')

		// set each result data to created elements

			title.innerHTML = data.results[i].title;
			date.innerHTML = data.results[i].release_date;

		// append new results from search to hard-coded format

		div.appendChild(img);
		div.appendChild(title);
		div.appendChild(date);
		document.querySelector("#movie-container").appendChild(div);

		}

	}

	</script>	

</body>
</html>